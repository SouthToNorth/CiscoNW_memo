# 静态路由

## 配置原则

- 1.有去有回
		- 这里必须破除初学者常见的两大迷信：
        远的都能通，近的当然一定会通；
        路由器自己知道把回包从接收的那个接口发送出去。

- 2.沿途所有路由器必须有到达目的网络的路由
- 3.路由的类型：直连路由、静态路由、动态路由。
    有路由才能通是基本原则，直连路由不需要手工配置，并不代表可以没有

- 4.路由是根据目的IP地址进行转发，然而源IP地址也同样重要，因为回包的时候要用到它
- 5.递归查找：最后一定要递归到某个接口，哪怕是虚拟接口
- 6.路由只需要知道目的网段的路由，不需要知道所经网段的路由

## 配置语法

- ip route为固定语法，以此命令配置表示为静态路由
- ip route 网络地址[掩码] {下一跳地址|出站接口}
- *扩展： ip route 网络地址 [掩码] {下一跳地址|出站接口} [管理距离]
- 举例:ip route 10.10.20.0 255.255.255.0 10.12.12.2
- 10.10.20.0 255.255.255.0，分别为目标网络的网络号和网络掩码
		- 注意：前缀和掩码配合主机位不能有1
		- 错误示范:ip route 10.10.20.1 255.255.255.0 10.12.12.2
- 10.12.12.2,为去往目标网络时要将数据发送给谁(下一跳)，也可使用发出数据的接口

## 静态路由汇总

- 去独联体以西的所有国家所有城市，下一跳是莫斯科
- 汇总静态路由探讨了一种多目的地单路径的情形

## 路由选择

- 最长匹配原则

## 管理距离

- 路由器判断一条路由的获得方式有多靠谱的标准
- 具体而言，路由器会相信管理距离值最小的那条路由
- 静态路由的管理距离为 1
- 如果想要通过备份路径实现冗余的静态路由，以那条路径的对端接口为下一跳地址，配置一条管理距离比较高的路由即可

## 浮动静态路由

- 当到某目的地存在多条路由时，可以配置不同权值的路由。而那些权值较大的路由都“隐藏”在路由表中，这些“隐藏”的路由被称为浮动静态路由，仅当首选路由失效时，才能被激活。
- 将管理距离保留为默认值，让它与第一个下一跳地址的那条路由管理距离相同，那么路由器会将去往该目的地的数据包发给哪个下一跳呢？

		*在浮动静态路由的案例中，当路由器转发去往该目的地址的数据包时，是无法同时使用这两条链路的，只有一条链路宕掉，另一条链路才会浮出水面

## 负载均衡

- 若要在D和E路由器之间实现两条链路负载分担某一路由转发的流量，方法就是使用相同的管理距离（比如都保留默认值）来配臵去往同一目的网络的静态路由，同时为它们指定不同的下一跳地址

## 实验

- 一个经典拓扑
- 基础实验
		- R1:ping 12.1.1.2
		- R1:ping 2.2.2.2
		- R1:ping 2.2.2.2 source 1.1.1.1
		- R1:ping 23.1.1.3
		- R1:ping 3.3.3.3
		- R1:ping 3.3.3.3 source 1.1.1.1
- 以太网环境静态路由和出接口  
- 不同的源地址，回来的路不同
